name: (Test) Get Latest Action Time

on:
  workflow_dispatch:

jobs:
  check_and_run:
    runs-on: ubuntu-latest
    steps:
    - name: Call API in Next Step
      run: |
        LAST_COMPLETED_TIME=$(curl -s \
          -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" \
          -H "Accept: application/vnd.github.v3+json" \
          "https://api.github.com/repos/${{ github.repository }}/actions/workflows/build-release_merge.yaml/runs?status=success&per_page=1" | \
          jq -r '.workflow_runs[0].completed_at')

        echo "Last completed time: $LAST_COMPLETED_TIME"
      shell: bash
